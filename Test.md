# DB 샤드 테스트 결과

- 샤드를 적용하기 전과 후, 어떻게 연산속도가 변화하였는지를 판단하기 위한 테스트를 기록합니다.
- 샤드를 적용한 경우에, 특정 연산에서 원래보다 얼마나 더 효율이 안좋아지는지도 함께 테스트 합니다.


## 샤드 적용 전

### 인기 이미지 조회

* 모든 사용자의 평가 평균점수를 매겨, 가장 높은 이미지를 페이징 하여 가져온다.
* 이미지 개수는 1,000,000개다.
* 평가 개수는 4,826,884개다.

|조회 테스트(ms)|1회차|2회차|3회차|4회차|5회차|평균|
|------|----|----|----|----|----|----|
|10개|7745|7464|7398|8207|7710|7704.8
|100개|8160|7963|8250|7714|7920|8001.4
|1000개|7860|7836|8043|8442|8167|8069.6
|1000000개|13689|13389|13548|13345|13576|13509.4



### 이미지 검색

* 특정 단어로 이미지를 검색하였다.
* 타이틀 자체를 특정 타이틀을 설정하여 균등하게 배분한 형태라, 단어 별 성능 차이는 크지 않았다.
* 아예 개수가 0개인 경우에는 빠르게 search가 끝나서 제외하였다.
* 해당 단어에 해당하는 이미지 개수는 143,000개다.

  |조회 테스트(ms)|1회차|2회차|3회차|4회차|5회차|평균|
  |------|----|----|----|----|----|----|
  |10개|496|488|491|470|466|482.2
  |100개|476|500|488|481|466|482.2
  |1000개|543|552|554|563|558|554
  |100000개|1735|1730|1790|1650|1770|1735


### 특정 사용자의 이미지 인기 조회

* 특정 사용자가 올린 이미지만을 인기 순으로 조회하였다. (다른 사용자들이 매긴 점수 기준)
* 사용자가 올린 이미지는 1000개이다.

|조회 테스트(ms)|1회차|2회차|3회차|4회차|5회차|평균|
|------|----|----|----|----|----|----|
|10개|559|542|545|543|541|546
|100개|550|545|542|559|551|549
|1000개|641|647|647|639|642|643.2



### 이미지 추가

* 이미지를 추가한다.
* 테스트 상 DB에 데이터가 들어가는 것만 계산하였고, 실제 파일이 저장되지는 않는다.

  |조회 테스트(ms)|1회차|2회차|3회차|4회차|5회차|평균|
  |------|----|----|----|----|----|----|
  |1개|76|74|65|81|71|73.4


### 평가 추가

* 이미지에 대한 평가를 추가한다.

  |조회 테스트(ms)|1회차|2회차|3회차|4회차|5회차|평균|
  |------|----|----|----|----|----|----|
  |1개|76|80|78|66|66|73.2


### 평가 수정

* 이미지에 대한 평가를 수정한다. (update 쿼리 평가)

  |조회 테스트(ms)|1회차|2회차|3회차|4회차|5회차|평균|
  |------|----|----|----|----|----|----|
  |1개|74|70|68|70|62|68.8


### 샤드 적용 전 테스트 평가

- 당연하게도, 샤드를 적용하지 않은 단일 DB 평가이기 때문에, 평범하게 각 쿼리의 데이터가 많을수록, 더 많은 시간이 걸렸다.
- 